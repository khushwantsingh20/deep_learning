import UrlDrivenTabs from '@alliance-software/djrad/components/UrlDrivenTabs';
import React from 'react';
import useModelClass from '@alliance-software/djrad/hooks/useModelClass';
import ApiCallsPanel from './ApiCallsPanel';
import useDevToolsData from './hooks/useDevToolsData';
import ModelFieldsTab from './ModelFieldsTab';
import ModelGeneralTab from './ModelGeneralTab';
import SourceLink from './SourceLink';

export default function ModelInspector({ model: modelOrModelId }) {
    const model = useModelClass(modelOrModelId);
    const devToolsData = useDevToolsData();
    const modelDevToolsData = devToolsData.getForModel(model);
    return (
        <>
            <h1>{model._meta.modelId}</h1>
            <p>
                <SourceLink source={modelDevToolsData.registration} />
            </p>
            <UrlDrivenTabs defaultActiveKey="details" animated={false}>
                <UrlDrivenTabs.TabPane tab="Model Details" url="details">
                    <ModelGeneralTab model={model} devtoolsData={modelDevToolsData} />
                </UrlDrivenTabs.TabPane>
                <UrlDrivenTabs.TabPane tab="Fields" url="fields">
                    <ModelFieldsTab model={model} devtoolsData={modelDevToolsData} />
                </UrlDrivenTabs.TabPane>
                <UrlDrivenTabs.TabPane tab="API" url="api">
                    <ApiCallsPanel
                        filter={apiCall => apiCall.endpoint.startsWith(modelDevToolsData.baseUrl)}
                    />
                </UrlDrivenTabs.TabPane>
            </UrlDrivenTabs>
        </>
    );
}
