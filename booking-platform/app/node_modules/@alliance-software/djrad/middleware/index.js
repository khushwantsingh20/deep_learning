import { apiMiddleware } from 'redux-api-middleware';
import { apiAuthRetryMiddleware } from 'alliance-redux-api/lib/middleware';
import batchApiMiddleware from './batchApiMiddleware';

let devTools;
try {
    devTools = require('@alliance-software/djrad-devtools/middleware').default;
} catch (e) {
    // Not installed
}

export default function buildDjradMiddleware(site, loginActionType) {
    return [
        devTools && devTools(),
        batchApiMiddleware(site),
        apiMiddleware,
        apiAuthRetryMiddleware(loginActionType),
    ].filter(Boolean);
}
