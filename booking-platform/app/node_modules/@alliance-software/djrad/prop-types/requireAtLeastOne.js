// @flow

/**
 * Given a prop types object augment it with extra checkers to verify that
 * at least one of the specified props exist. Can specify multiple lists of
 * props to verify.
 *
 * @example
 *
 * ```js
 * class MyComponent {
 *     static propTypes = {
 *          // You can choose any key here. Because of how prop types work we just assign the error
 *          // to a dummy prop name.
 *         _required: requireAtLeastOne(['record', 'model'], ['children', 'render', 'component']),
 *     }
 *     ...
 * }
 *
 * // <MyComponent />
 * // Error: You must specify at least one of model, record
 * // Error: You must specify at least one of children, render, component
 * ```
 */
export default function requireAtLeastOne(...combos: Array<Array<string>>): (props: {}) => void {
    return (props: {}) => {
        const allErrors = combos.reduce((errors, propNames) => {
            if (propNames.map(propName => props[propName]).filter(Boolean).length === 0) {
                errors.push(`You must specify at least one of ${propNames.join(', ')}`);
            }
            return errors;
        }, []);
        if (allErrors.length > 0) {
            throw new Error(allErrors.join('\n'));
        }
    };
}
