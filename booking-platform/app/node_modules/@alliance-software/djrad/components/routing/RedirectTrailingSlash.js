import React from 'react';
import { Route, Redirect } from 'react-router';
import { devLogger } from '../../util/log';

/**
 * Forces a redirect to current url with a trailing slash when no trailing slash is presents.
 *
 * Logs a warning when in development hinting to the developer to fix up any links that don't contain
 * an explicit trailing slash.
 *
 * You don't need to use this component directly as it included by default in `DjradProvider` -
 * pass `trailingSlash={false}` to disable.
 */
export default function RedirectTrailingSlash() {
    return (
        <Route
            exact
            strict
            path="/:url*"
            render={props => {
                devLogger.warn(
                    `Urls should end with a trailing slash. Received '${
                        props.match.url
                    }'. If this URL was used in a link please update usage to include trailing slash.`
                );
                return (
                    <Redirect
                        to={{
                            ...props.location,
                            pathname: `${props.location.pathname}/`,
                        }}
                    />
                );
            }}
        />
    );
}
