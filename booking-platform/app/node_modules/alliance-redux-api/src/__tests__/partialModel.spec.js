import { Maybe } from 'typed-immutable';
import Model, { $modelDefinition } from '../Model';
import Field from '../Field';

const DateField = Field(Date, value => value.toDateString());

test('serialize model', () => {
    const Person = Model(
        {
            id: Number,
            name: String,
            dob: DateField,
            age: Maybe(Number),
        },
        'person',
        'Person'
    );

    const { partialRecordClass: PartialPerson } = Person[$modelDefinition];
    try {
        new Person({});
        expect(true).toBe(false);
    } catch (e) {
        // Should throw
    }
    let value = new PartialPerson({});
    expect(value.id).toBe(null);
    expect(value.age).toBe(null);

    value = new PartialPerson({
        id: 1,
        age: 5,
    });
    expect(value.id).toBe(1);
    expect(value.age).toBe(5);
});
